"use strict";class AutoComplete{constructor(){"undefined"==typeof greenmart_settings||this._callAjaxSearch()}_callAjaxSearch(){var a=this,b=greenmart_settings.ajaxurl+"?action=greenmart_autocomplete_search&security="+greenmart_settings.search_nonce,c=jQuery("form.greenmart-ajax-search"),d=function(a){return a.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")};c.each(function(){var f=jQuery(this),g=f.find("input[name=s]"),h=!!f.data("thumbnail"),i=!!f.data("price");g.devbridgeAutocomplete({serviceUrl:a._AutoServiceUrl(g,b),minChars:a._AutoMinChars(g),appendTo:a._AutoAppendTo(g),width:"100%",maxHeight:"initial",onSelect:function(a){0<a.link.length&&(window.location.href=a.link)},onSearchStart:function(){let a=g.parents("form");a.addClass("tbay-loading")},beforeRender:function(a,b){"undefined"!=typeof b[0].result&&jQuery(a).prepend("<div class=\"list-header\"><span>"+b[0].result+"</span></div>"),b[0].view_all&&jQuery(a).append("<div class=\"view-all-products\"><span>"+greenmart_settings.view_all+"</span></div>")},onSearchComplete:function(){c.removeClass("tbay-loading"),jQuery(this).parents("form").addClass("open"),jQuery(document.body).trigger("tbay_searchcomplete")},formatResult:(b,c)=>{let f=a._initformatResult(b,c,d,h,i);return f},onHide:function(){jQuery(this).parents("form").hasClass("open")&&jQuery(this).parents("form").removeClass("open")}}),jQuery("body").click(function(){g.is(":focus")||g.each(function(){let a=jQuery(this).devbridgeAutocomplete();"undefined"==typeof a||a.hide()})})});var f=c.find("[name=\"product_cat\"], [name=\"category\"]");f.length&&f.change(function(c){let d=jQuery(c.target).parents("form").find("input[name=s]"),f=d.devbridgeAutocomplete();f.hide(),f.setOptions({serviceUrl:a._AutoServiceUrl(d,b)}),f.onValueChange()}),jQuery(document.body).on("tbay_searchcomplete",function(){jQuery(".view-all-products").on("click",function(){jQuery(this).parents("form").submit(),e.stopPropagation()})})}_AutoServiceUrl(a,b){let c=a.parents("form"),d=parseInt(c.data("count")),f=c.data("post-type");c.data("search-in");let g=c.find("[name=\"product_cat\"], [name=\"category\"]").val();return 0<d&&(b+="&number="+d),b+="&post_type="+f,g&&(b+="&product_cat="+g),b}_AutoAppendTo(a){let b=a.parents("form"),c="undefined"==typeof b.data("appendto")?b.find(".greenmart-search-results"):b.data("appendto");return c}_AutoMinChars(a){let b=a.parents("form"),c=parseInt(b.data("minchars"));return c}_initformatResult(a,b,c,d,f){"&"==b&&(b="&#038;");var g="("+c(b)+")",h="";return d&&a.image&&(h+=" <div class=\"suggestion-thumb\">"+a.image+"</div>"),h+="<div class=\"suggestion-group\">",h+="<div class=\"suggestion-title product-title\">"+a.value.replace(new RegExp(g,"gi"),"<strong>$1</strong>").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/&lt;(\/?strong)&gt;/g,"<$1>")+"</div>",a.no_found&&(h="<div class=\"suggestion-title no-found-msg\">"+a.value+"</div>"),f&&a.price&&(h+=" <div class=\"suggestion-price price\">"+a.price+"</div>"),h+="</div>",h}}jQuery(document).ready(()=>{new AutoComplete});var AutoCompleteHandler=function(){new AutoComplete};jQuery(window).on("elementor/frontend/init",function(){elementorFrontend.hooks.addAction("frontend/element_ready/tbay-search-form.default",AutoCompleteHandler)});
