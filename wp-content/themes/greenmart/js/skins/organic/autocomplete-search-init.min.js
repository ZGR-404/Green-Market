"use strict";class AutoComplete{constructor(){if("undefined"!=typeof greenmart_settings){var a=this;a._callAjaxSearch(),jQuery(document.body).on("search_device_mobile",()=>{a._callAjaxSearch()})}}_callAjaxSearch(){var a=jQuery("input[name=s]");a.on("focus",function(){var a=jQuery(this),b="undefined"==typeof jQuery(this).parents("form").data("appendto")?"":jQuery(this).parents("form").data("appendto");jQuery(this).autocomplete({source:function(c,d){$.ajax({url:greenmart_settings.ajaxurl+"?callback=?&action="+"greenmart_autocomplete_search",dataType:"json",data:{term:c.term,category:this.element.parent().find(".dropdown_product_cat").val(),style:this.element.data("style"),post_type:this.element.parent().find(".post_type").val(),security:greenmart_settings.search_nonce},success:function(c){!c.length&&1<a.val().length&&0<a.parents("form").find(b).find("ul").length&&a.parents("form").find(b).find("ul li").remove(),d(c)}})},minLength:2,appendTo:b,autoFocus:!0,search:function(a){jQuery(a.currentTarget).parents(".tbay-search-form").addClass("load")},select:function(a,b){window.location.href=b.item.link},create:function(){jQuery(this).data("ui-autocomplete")._renderItem=function(a,b){var c="";if(""!=b.image)var c="<a class=\"image\" href=\""+b.link+"\" title=\""+b.label+"\"><img class=\"pull-left\" src=\""+b.image+"\" style=\"margin-right:10px;\"></a>";return c+="<div class=\"group\">",c+="<div class=\"name\"><a href=\""+b.link+"\" title=\""+b.label+"\">"+b.label+"</a></div>",""!=b.price&&(c+="<div class=\"price\">"+b.price+"</div> "),c+="</div>",jQuery("<li>").append(c).appendTo(a)},jQuery(this).data("ui-autocomplete")._renderMenu=function(a,b){var c=this;jQuery.each(b,function(b,d){c._renderItemData(a,d)}),b[0].view_all?(a.append("<li class=\"list-header ui-menu-divider\">"+b[0].result+"</li>"),a.append("<li class=\"list-bottom ui-menu-divider\"><a class=\"search-view-all\" href=\"javascript:void(0)\">"+greenmart_settings.view_all+"</a></li>")):a.append("<li class=\"list-header ui-menu-divider\">"+b[0].result+"</li>"),jQuery(document.body).trigger("greenmart_search_view_all")}},response:function(a,b){0===b.content.length?(jQuery(".tbay-preloader").text(greenmart_settings.no_results),jQuery(".tbay-preloader").addClass("no-results")):(jQuery(".tbay-preloader").empty(),jQuery(".tbay-preloader").removeClass("no-results"))},open:function(a){jQuery(a.target).parents(".tbay-search-form").removeClass("load"),jQuery(a.target).parents(".tbay-search-form").addClass("active")},close:function(){}}).focus(function(){1<a.val().length&&(0<a.parents("form").find(b).find("ul li").length&&a.parents("form").find(b).find("ul").show(),a.trigger(jQuery.Event("keydown")))})}),jQuery(document.body).on("greenmart_search_view_all",()=>{jQuery(".search-view-all").on("click",function(){jQuery(this).parents("form").submit()})}),jQuery(".tbay-preloader").on("click",function(){jQuery(this).parents(".tbay-search-form").removeClass("active"),jQuery(this).parents(".tbay-search-form").find("input[name=s]").val("")}),jQuery("input[name=s]").keyup(function(){0==jQuery(this).val().length&&(jQuery(this).parents(".tbay-search-form").removeClass("load"),jQuery(this).parents(".tbay-search-form").removeClass("active"),jQuery(this).parents(".tbay-search-form").find(".tbay-preloader").empty())})}}jQuery(document).ready(function(){new AutoComplete});
